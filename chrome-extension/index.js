!function(){var e=6e4,t=!1,n=!1;let o,s,a=[],r="[data-testid='unfilled_kudos']";const i=()=>{setTimeout((()=>{const n=c()?.[0];if(n)n.parentNode.click(),i();else if(t){console.log("Timeout Started:"+Date());var o=(new Date).getTime(),s=new Date(o+Number(e));console.log("Refresh Time:"+s),setTimeout(d,e)}}),1e3)},d=()=>{console.log("Refresh page"),window.location.reload(),n&&setTimeout(i,1e3)},l=()=>{chrome.storage.sync.get({refreshInterval:60,refreshIntervalActive:!1,autoKudosActive:!1},(function(o){e=6e4*o.refreshInterval,t=o.refreshIntervalActive,n=o.autoKudosActive}))},c=()=>{const e=document.querySelectorAll('[data-testid="owner-avatar"]'),t=[];return e.forEach((e=>{if(!e.href.includes(s)){const n=e.closest('[class*="--child-entry"]')||e.closest('[data-testid="web-feed-entry"]');n.querySelector(r)&&t.push(n.querySelector(r))}})),t},u=()=>{const e=document.getElementById("skCount");s=document.querySelector(".user-menu > a")?.href?.match(/\d+/)?.[0],e&&setInterval((()=>{a=c(),e.innerHTML=a.length,(()=>{const e=a.length;e?(o.classList.remove("hidden"),e<100?o.classList.add("lockout"):o.classList.remove("lockout")):o.classList.add("hidden")})()}),1e3)};(()=>{const e=document.createElement("style");e.innerHTML="\n      #stravaKudos {\n        display: flex;\n        flex-direction: column;\n        left: 5px;\n        font-size: 20px;\n        box-shadow: 0 2px 1px rgba(0, 0, 0, 0.2);\n        z-index: 49;\n        position: fixed;\n        top: 61px\n      }\n\n      #stravaKudos div {\n        margin: 0 auto\n      }\n\n      #stravaKudos p {\n        margin: 0;\n        font-size: 14px\n      }\n\n      #stravaKudos.hidden,\n      #stravaKudos.lockout p {\n        display: none !important;\n        visibility: hidden !important\n      }\n\n      #stravaKudosCount {\n        margin: 0 3px;\n        font-weight: bold\n      }\n    ",document.head.prepend(e),o=document.createElement("button"),o.id="stravaKudos",o.innerHTML='\n      <div>Give <span id="skCount"></span> Kudos</div>\n      <p>Strava may throttle too<br/>many Kudos in one session</p>\n    ',o.className="btn btn-sm btn-primary hidden",o.addEventListener("click",i),document.body.prepend(o),u(),l()})(),setTimeout((()=>{console.log("AK:"+n+" RI:"+e+" RIA:"+t),n&&setTimeout(i,1e3)}),1e4)}();
